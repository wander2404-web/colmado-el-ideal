<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Colmado El Ideal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg:#f4f4f4;
  --card:#fff;
  --text:#000;
  --main:#f57c00;
}

.dark {
  --bg:#121212;
  --card:#1e1e1e;
  --text:#fff;
}

body {
  margin:0;
  font-family: Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}

/* HEADER */
header {
  background:var(--main);
  color:#fff;
  padding:15px;
}

.header {
  max-width:1200px;
  margin:auto;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.logo {
  display:flex;
  align-items:center;
  gap:10px;
}

.logo img {
  width:70px;
}

.search input {
  padding:8px;
  border-radius:20px;
  border:none;
}

.cart-btn, .dark-btn {
  cursor:pointer;
  font-size:18px;
}

/* CONTENEDOR */
.container {
  max-width:1200px;
  margin:auto;
  padding:15px;
}

.products {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:15px;
}

.product {
  background:var(--card);
  border-radius:10px;
  padding:10px;
  text-align:center;
}

.product img {
  width:100%;
  height:130px;
  object-fit:contain;
}

.controls {
  display:flex;
  justify-content:center;
  gap:10px;
}

button {
  cursor:pointer;
}

/* CARRITO */
#cart {
  position:fixed;
  right:0;
  top:0;
  width:320px;
  height:100%;
  background:var(--card);
  box-shadow:-3px 0 10px rgba(0,0,0,.3);
  padding:15px;
  display:none;
  overflow:auto;
}

/* ADMIN */
.admin {
  margin:20px 0;
  background:var(--card);
  padding:10px;
  border-radius:10px;
}
</style>
</head>

<body>

<header>
  <div class="header">
    <div class="logo">
      <img src="https://via.placeholder.com/150">
      <h2>Colmado El Ideal</h2>
    </div>

    <div class="search">
      <input id="search" placeholder="Buscar...">
    </div>

    <div class="dark-btn" onclick="toggleDark()">ðŸŒ™</div>
    <div class="cart-btn" onclick="toggleCart()">ðŸ›’ <span id="count">0</span></div>
  </div>
</header>

<div class="container">

  <!-- PANEL ADMIN -->
  <div class="admin">
    <h3>âž• Agregar producto</h3>
    <input id="pname" placeholder="Nombre">
    <input id="pprice" placeholder="Precio" type="number">
    <button onclick="addProduct()">Agregar</button>
  </div>

  <div class="products" id="products"></div>
</div>

<!-- CARRITO -->
<div id="cart">
  <h3>ðŸ›’ Pedido</h3>
  <div id="cartItems"></div>
  <h4>Total: RD$ <span id="total">0</span></h4>
  <button onclick="sendWhatsApp()">ðŸ“² Enviar por WhatsApp</button>
</div>

<script>
let products = JSON.parse(localStorage.getItem("products")) || [];
let cart = JSON.parse(localStorage.getItem("cart")) || {};
let show = 0;

/* PRODUCTOS BASE */
if(products.length === 0){
  for(let i=1;i<=100;i++){
    products.push({name:"Producto "+i,price:50+i});
  }
}

/* CARGA */
function load(){
  let cont = document.getElementById("products");
  for(let i=0;i<20 && show<products.length;i++){
    let p = products[show++];
    cont.innerHTML += `
      <div class="product">
        <img src="https://via.placeholder.com/200">
        <h4>${p.name}</h4>
        <p>RD$ ${p.price}</p>
        <div class="controls">
          <button onclick="add('${p.name}',${p.price})">+</button>
          <button onclick="remove('${p.name}')">-</button>
        </div>
      </div>`;
  }
}

/* SCROLL */
window.onscroll=()=> {
  if(innerHeight+scrollY>=document.body.offsetHeight-200) load();
};

/* BUSCAR */
search.oninput=()=>{
  productsDiv.innerHTML="";
  show=0;
  let f = products.filter(p=>p.name.toLowerCase().includes(search.value.toLowerCase()));
  products=f;
  load();
};

/* CARRITO */
function add(n,p){
  cart[n]=(cart[n]||{q:0,p}).q++;
  save();
}

function remove(n){
  if(cart[n]){
    cart[n].q--;
    if(cart[n].q<=0) delete cart[n];
    save();
  }
}

function save(){
  localStorage.setItem("cart",JSON.stringify(cart));
  updateCart();
}

function updateCart(){
  cartItems.innerHTML="";
  let t=0,c=0;
  for(let k in cart){
    let i=cart[k];
    t+=i.q*i.p;
    c+=i.q;
    cartItems.innerHTML+=`${k} x${i.q}<br>`;
  }
  total.innerText=t;
  count.innerText=c;
}

/* WHATSAPP */
function sendWhatsApp(){
  let msg="Pedido:%0A";
  for(let k in cart){
    msg+=`${k} x${cart[k].q}%0A`;
  }
  msg+=`Total RD$ ${total.innerText}`;
  window.open(`https://wa.me/18000000000?text=${msg}`);
}

/* ADMIN */
function addProduct(){
  products.unshift({name:pname.value,price:pprice.value});
  localStorage.setItem("products",JSON.stringify(products));
  location.reload();
}

/* MODO OSCURO */
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("dark",document.body.classList.contains("dark"));
}

if(localStorage.getItem("dark")=="true") document.body.classList.add("dark");

load(); updateCart();
</script>

</body>
</html>
