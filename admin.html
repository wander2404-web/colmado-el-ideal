<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Colmado El Ideal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial; margin:0; background:#f5f5f5; }
header { background:#fff; padding:10px; position:sticky; top:0; z-index:10; box-shadow:0 2px 5px rgba(0,0,0,.1); }
header img { max-width:100%; height:90px; display:block; margin:auto; }

.search { padding:10px; }
.search input { width:100%; padding:10px; font-size:16px; }

.products { display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:10px; padding:10px; }
.card { background:#fff; padding:10px; border-radius:8px; text-align:center; }
.card img { width:100%; height:120px; object-fit:contain; }
.qty { display:flex; justify-content:center; gap:10px; margin-top:5px; }
button { padding:5px 10px; }

.cart { background:#fff; padding:10px; margin:10px; border-radius:8px; }
.cart button { width:100%; margin-top:5px; }

.admin { background:#fff; padding:10px; margin:10px; border-radius:8px; }
.hidden { display:none; }

input, select { width:100%; padding:6px; margin-bottom:5px; }
</style>
</head>

<body>

<header>
<img src="logotipo.png">
</header>

<div class="search">
<input type="text" id="search" placeholder="ğŸ” Buscar producto...">
</div>

<div class="products" id="products"></div>

<div class="cart">
<h3>ğŸ›’ Pedido</h3>
<div id="cartItems"></div>
<button onclick="sendWhatsApp()">ğŸ“² Enviar pedido</button>
<button onclick="clearCart()">ğŸ—‘ Vaciar carrito</button>
</div>

<div class="admin">
<h3>ğŸ” Panel administrador</h3>

<div id="login">
<input type="password" id="pass" placeholder="Clave">
<button onclick="login()">Entrar</button>
</div>

<div id="panel" class="hidden">
<h4>Productos</h4>
<div id="adminProducts"></div>

<h4>Agregar / Editar</h4>
<input id="pName" placeholder="Nombre">
<input id="pPrice" placeholder="Precio">
<input id="pImg" placeholder="URL imagen">
<button onclick="saveProduct()">Guardar</button>
</div>
</div>

<script>
const ADMIN_PASS = "2404";

let products = JSON.parse(localStorage.getItem("products")) || [
 {id:1,name:"Arroz",price:50,img:"https://i.imgur.com/7QKJQyN.png"},
 {id:2,name:"Aceite",price:150,img:"https://i.imgur.com/8mLk0aP.png"},
 {id:3,name:"Habichuelas",price:80,img:"https://i.imgur.com/RW5XkqB.png"},
 {id:4,name:"AzÃºcar",price:45,img:"https://i.imgur.com/m6Zs7pX.png"},
 {id:5,name:"Leche",price:70,img:"https://i.imgur.com/NQjvYqg.png"}
];

let cart = JSON.parse(localStorage.getItem("cart")) || [];

function saveData(){
 localStorage.setItem("products",JSON.stringify(products));
 localStorage.setItem("cart",JSON.stringify(cart));
}

function render(){
 let pDiv=document.getElementById("products");
 pDiv.innerHTML="";
 let s=document.getElementById("search").value.toLowerCase();

 products.filter(p=>p.name.toLowerCase().includes(s)).forEach(p=>{
  let q=cart.find(i=>i.id==p.id)?.qty||0;
  pDiv.innerHTML+=`
  <div class="card">
   <img src="${p.img}">
   <b>${p.name}</b><br>$${p.price}
   <div class="qty">
    <button onclick="add(${p.id},-1)">âˆ’</button>
    ${q}
    <button onclick="add(${p.id},1)">+</button>
   </div>
  </div>`;
 });

 let cDiv=document.getElementById("cartItems");
 cDiv.innerHTML="";
 cart.forEach(i=>{
  let p=products.find(p=>p.id==i.id);
  cDiv.innerHTML+=`${p.name} x ${i.qty} <button onclick="remove(${i.id})">âŒ</button><br>`;
 });

 saveData();
 renderAdmin();
}

function add(id,q){
 let i=cart.find(x=>x.id==id);
 if(!i && q>0) cart.push({id,qty:q});
 else if(i){ i.qty+=q; if(i.qty<=0) cart=cart.filter(x=>x.id!=id);}
 render();
}

function remove(id){ cart=cart.filter(x=>x.id!=id); render(); }
function clearCart(){ cart=[]; render(); }

function sendWhatsApp(){
 let msg="Pedido:%0A";
 cart.forEach(i=>{
  let p=products.find(p=>p.id==i.id);
  msg+=`${p.name} x ${i.qty}%0A`;
 });
 window.open("https://wa.me/18090000000?text="+msg);
}

function login(){
 if(document.getElementById("pass").value===ADMIN_PASS){
  localStorage.setItem("admin","ok");
  document.getElementById("login").classList.add("hidden");
  document.getElementById("panel").classList.remove("hidden");
 } else alert("Clave incorrecta");
}

function renderAdmin(){
 let a=document.getElementById("adminProducts");
 if(!a) return;
 a.innerHTML="";
 products.forEach(p=>{
  a.innerHTML+=`${p.name} ($${p.price})
  <button onclick="edit(${p.id})">âœï¸</button>
  <button onclick="del(${p.id})">ğŸ—‘</button><br>`;
 });
}

function edit(id){
 let p=products.find(x=>x.id==id);
 pName.value=p.name; pPrice.value=p.price; pImg.value=p.img;
 pName.dataset.id=id;
}

function del(id){ products=products.filter(x=>x.id!=id); render(); }

function saveProduct(){
 let id=pName.dataset.id;
 if(id){
  let p=products.find(x=>x.id==id);
  p.name=pName.value; p.price=pPrice.value; p.img=pImg.value;
 } else {
  products.push({id:Date.now(),name:pName.value,price:pPrice.value,img:pImg.value});
 }
 pName.value=pPrice.value=pImg.value="";
 pName.dataset.id="";
 render();
}

if(localStorage.getItem("admin")=="ok"){
 document.getElementById("login").classList.add("hidden");
 document.getElementById("panel").classList.remove("hidden");
}

render();
</script>

</body>
</html>
